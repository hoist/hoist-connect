{"version":3,"sources":["lock.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;;;;;;;;;;;sBACM,QAAQ;;;;yBACL,YAAY;;;;qBAChB,OAAO;;;;wBACL,YAAY;;;;AAEhC,IAAI,MAAM,YAAA,CAAC;;IAEL,YAAY;AACL,WADP,YAAY,GACF;0BADV,YAAY;;AAEd,+BAFE,YAAY,6CAEN;AACR,QAAI,CAAC,MAAM,GAAG,YAAY,CAAC,UAAU,EAAE,CAAC;AACxC,QAAI,CAAC,IAAI,GAAG,4BAAU,IAAI,CAAC,MAAM,CAAC,CAAC;GACpC;;YALG,YAAY;;eAAZ,YAAY;;WAMN,oBAAC,IAAI,EAAE,OAAO,EAAE;;;AAExB,aAAO,GAAG,OAAO,IAAI,GAAG,CAAC;AACzB,aAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAK;AAC9B,cAAK,IAAI,CAAC,IAAI,EAAE,OAAO,EAAE,UAAU,IAAI,EAAE;AACvC,cAAI,CAAC,OAAO,GAAG,IAAI,CAAC;AACpB,iBAAO,CAAC,IAAI,CAAC,CAAC;SACf,CAAC,CAAC;OACJ,CAAC,CAAC;KACJ;;;SAfG,YAAY;;;AAmBlB,YAAY,CAAC,UAAU,GAAG,YAAY;AACpC,SAAO,MAAM,KAAK,MAAM,GAAG,mBAAM,YAAY,CAAC,oBAAO,GAAG,CAAC,kBAAkB,CAAC,EAAE,oBAAO,GAAG,CAAC,kBAAkB,CAAC,CAAC,CAAA,AAAC,CAAC;CAChH,CAAC;;qBAIa,YAAY","file":"lock.js","sourcesContent":["'use strict';\nimport config from 'config';\nimport redisLock from 'redis-lock';\nimport redis from 'redis';\nimport BaseAPI from './base_api';\n\nlet client;\n\nclass HoistLockAPI extends BaseAPI {\n  constructor() {\n    super();\n    this.client = HoistLockAPI._getClient();\n    this.lock = redisLock(this.client);\n  }\n  aquireLock(name, timeout) {\n\n    timeout = timeout || 500;\n    return new Promise((resolve) => {\n      this.lock(name, timeout, function (done) {\n        this.release = done;\n        resolve(this);\n      });\n    });\n  }\n}\n\n\nHoistLockAPI._getClient = function () {\n  return client || (client = redis.createClient(config.get('Hoist.redis.port'), config.get('Hoist.redis.host')));\n};\n\n\n\nexport default HoistLockAPI;\n"],"sourceRoot":"/source/"}